===============================================================================

	PMD用 MusicCompiler評価版 "MCH.EXE" ver.4.8	Document
						by M.Kajihara(KAJA)

===============================================================================

	MCH.EXEは、PMD用MMLコンパイラである"MC.EXE"の評価版です。
	(MC.EXEは、現在は即売会及び通販でしか手に入りません。)

	MCH.EXEは、MC.EXEから、コンパイル後のデータの保存機能のみをCUTした
	もので、これだけでもMMLの作成及び演奏等、PMDで曲を作る醍醐味は
	味わって頂ける筈です。

===============================================================================
	使用方法
-------------------------------------------------------------------------------

>MCH [/Option[/Option]] MMLファイル名[.MML] FM音色ファイル名[.FF]
	(拡張子は省略可)

	とすると、エラーが無い限り、.MMLをコンパイルして演奏します。
	エラーがあった場合は、その時点で、エラー箇所とエラーメッセージを表示
	して終了します。

	当然ですが、使用する前にPMDを常駐しておいて下さい。

	アップロードされている殆どのMMLデータは、
>MCH filename[.MML]
	とするだけで、コンパイル＆演奏されます。

	MMLの仕様については PMDMML.MAN をご覧下さい。

(注)	PMDを常駐してからこのコンパイラを使用する場合、PMD音色データバッファの
	大きさはデフォルトの8KBを維持して下さい。(->PMDの/Vオプション)

===============================================================================
	オプションについて
-------------------------------------------------------------------------------
	環境変数 "MCOPT=" が定義されている場合は、その文字列を自動的に
	オプションとして取り込みます。

	コマンドラインで同時に使用出来ないオプションとぶつかった場合は、
	コマンドラインの方のオプションが優先されます。

	使用出来るオプションは以下の通りです。

-------------------------------------------------------------------------------
/N
-------------------------------------------------------------------------------
	OPN仕様(DT2無し/ABCDEF=FM,GHI=SSG)でコンパイルします。
	デフォルトなので指定する必要はありません。

-------------------------------------------------------------------------------
/L
-------------------------------------------------------------------------------
	OPL仕様(2op音色/ABCDEFGHI=FM)でコンパイルします。
	IBMPCのPMD用の曲を作成する時にのみ使用します。

-------------------------------------------------------------------------------
/A
-------------------------------------------------------------------------------
	PCMデータを読み込まないようにします。
	PMDB2/PMDVA/PMD86が常駐している場合、曲演奏時にMML中に#PCMFile等で指定
	しているPCMデータを読み込みますが、このオプションはそれを抑制します。

-------------------------------------------------------------------------------
/O
-------------------------------------------------------------------------------
	Title文字列を表示しないようにします。
	演奏開始と同時に、PCMファイル名、曲のタイトル、作曲／編曲者名、メモが
	MML中に定義されていれば表示しますが、このオプションはそれを抑制します。

-------------------------------------------------------------------------------
/C
-------------------------------------------------------------------------------
	コンパイル後にパート毎の長さを表示します。( 全体 / L指定後 )
	ループする際にずれている場合のCHECKをする時に有効です。

	但し、[ ･･･ ]0 といった、局所無限ループがあった場合は、
	長さは表示されません。

-------------------------------------------------------------------------------

!注意!	.MMLデータと、MML内で指定される#includeファイルとの合計の、最大
	コンパイル可能サイズが61KB(62,464bytes)になっています。
	それ以上大きなMMLファイル、又は#includeで指定されるファイルを合計した
	サイズがそれ以上大きくなるとコンパイル出来ませんので注意してください。
	また、コンパイル後のデータの最大は63KB(64,512bytes)になっています。

===============================================================================
	FM音源の音色データ(以下"音色")の扱いについて
-------------------------------------------------------------------------------

	MCH.EXEでの音色の扱いはいろいろと複雑になっています。最初のうちは、
	MML中に曲中で使用する総ての音色を定義しておけば、それほど混乱する事は
	ないはずです。
	慣れて来たら、以下の説明文を読んでさらに使いこなしてみて下さい。

-------------------------------------------------------------------------------

	大抵の他の音楽ドライバの場合は、音色はMML中に全て定義するものが多いの
	ですが、MCH.EXEの場合、以下の種類の音色ソースが利用できます。

-------------------------------------------------------------------------------
1)	MML中に定義されている音色。
-------------------------------------------------------------------------------
	自動的に使用されます。

	普通にMML中に定義されている音色です。これだけで賄ったとしても
	何の問題もありません。

-------------------------------------------------------------------------------
2)	付属の音色エディタ"VED.EXE"で作成される、拡張子 .FF のファイル。
-------------------------------------------------------------------------------
1.	コマンドラインに音色ファイル名を指定してある
2.	使用されている音色がMML中に定義されていない
	の２つの条件が重なった場合に、使用されます。

	例えば88のプリセット音だけで曲を作成したといった場合、
	付属の"PC88.FF"という音色ファイル名をコンパイル時にコマンドラインに追加
	するだけで、音色をMML中に定義する必要がなくなります。

-------------------------------------------------------------------------------
3)	PMD内部の音色データエリア中の音色。
-------------------------------------------------------------------------------
1.	使用されている音色がMML中に定義されていない
2.	音色ファイル名が指定されている場合、音色ファイル内にも定義されていない
	(例えば音色データが@128までしか無い音色ファイルを指定して、MML内で
	 @200が使われ、且つその音色はMML中で定義されていない場合)
	の２つの条件が重なった場合に、自動的に使用されます。
	
	VED.EXEで作成された .FF フォーマットの音色は、VSET.COM でPMD内部に
	転送出来ます。2)の例をこの場合にあてはめると、VSETでPC88.FFをPMD内部に
	あらかじめ転送してあれば、コンパイル時にコマンドラインにPC88.FFと
	指定する必要もなくなります。

-------------------------------------------------------------------------------

	MCH.EXEの場合、演奏直前に、MML及び音色Fileに定義されている音色が
	自動的にPMD内部音色データエリアに転送されます。ですから、VSET.COMで
	PMD内音色データエリアに音色データを転送しても、MCH.EXE実行後は
	いくつかの音色が変化している可能性があることに注意して下さい。

===============================================================================
	環境変数 PMD について
-------------------------------------------------------------------------------
	コンパイル時のMMLファイル、音色ファイル、#Includeファイル、
	演奏時のPCMファイルは、カレントに見つからないと、
	SET PMD= で指定された環境変数を探して、それをパスとしてサーチします。
	SET PATH= と全く同様の書式で指定します。

	また、現Versionでは、ファイルにパス名を記しておいても、見つからなければ
	指定されたパスを削除の上、SET PMD=で指定されたパスを探しに
	行きますので、注意して下さい。

	環境変数PATHと同様、特にDISKベースでの使用の場合は、良く使うパスを
	先に書いておいた方がサーチが速くなりますので、順番を良く考えて
	設定して下さい。

===============================================================================
	環境変数 USER,COMPOSER,ARRANGER について
-------------------------------------------------------------------------------
	MML中で #Composer , #Arranger 命令の表記がされていなかった場合、

	#Composerの場合、
	環境変数 "COMPOSER=" , "USER=" を検索

	#Arrangerの場合、
	環境変数 "ARRANGER=" , "USER=" を検索

	して、発見した場合はそこに定義されている文字列を使用します。
	重複した場合は、環境変数 COMPOSER,ARRANGER が優先されます。

===============================================================================
--------Exsamples
-------------------------------------------------------------------------------

>mch sam1
	sam1.mmlをコンパイルして演奏する。

>mc /o sam2
	sam2.mmlをコンパイルして演奏する。その際タイトル文字列は表示しない。

>mc /a sam4
	sam4.mmlをコンパイルして演奏する。その際ADPCMデータは定義しない。

>mc sam3 effec
	sam3.mmlをコンパイルして演奏する。
	MML中に定義されていない音色は、effec.ff内の音色を利用する。

===============================================================================
			-----	End of MCH.DOC	-----
===============================================================================
